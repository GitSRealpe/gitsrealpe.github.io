<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

    <script>
    var config = {
        type: Phaser.AUTO,
		width: 600,
		height: 600,
		transparent: true,
		backgroundColor: 'rgba(255,55,222,0.5)',
		//zoom: 3, // Since we're working with 16x16 pixel tiles, let's scale up the canvas by 3x
		pixelArt: true, // Force the game to scale images up crisply
		physics:{
		default: "arcade",
		arcade:{
			gravity: {y:0}
			}
		},
        scene: {
            preload: preload,
            create: create,
			update: update,
        }
    };

    var game = new Phaser.Game(config);
	let cursors;
	let player;
	let showDebug = false;

    function preload ()
    {
		this.load.tilemapTiledJSON('map', 'assets/tilemaps/otromapa.json');
        this.load.image("tiles", "assets/tilesets/multiplos.png");
		this.load.spritesheet('gamerh', 'assets/sprites/hm_sprites_hall.png', {frameWidth: 32, frameHeight:32});
		this.load.spritesheet('gamerv', 'assets/sprites/hm_sprites_vall.png', {frameWidth: 32, frameHeight:32});
    }

    function create ()
    {
    var map = this.make.tilemap({ key: "map" });
    var tileset = map.addTilesetImage('baldosas', 'tiles');
    var top_layer = map.createStaticLayer('Tile Layer 1', tileset, 0, 0);
	
	player = this.physics.add.sprite(200, 200, 'gamerh');
	
	this.anims.create({
		key: 'walk-right',
		frames: this.anims.generateFrameNumbers('gamerh', { start: 0, end: 7 }),
		frameRate: 15,
		repeat: -1
	});
	this.anims.create({
		key: 'walk-left',
		frames: this.anims.generateFrameNumbers('gamerh', { start: 8, end: 15 }),
		frameRate: 15,
		repeat: -1
	});
	
	this.anims.create({
		key: 'walk-up',
		frames: this.anims.generateFrameNumbers('gamerv', { start: 0, end: 7 }),
		frameRate: 15,
		repeat: -1
	});
	this.anims.create({
		key: 'walk-down',
		frames: this.anims.generateFrameNumbers('gamerv', { start: 8, end: 15 }),
		frameRate: 15,
		repeat: -1
	});
	
	cursors = this.input.keyboard.createCursorKeys();
		
    }
	
	function update(time, delta){
		const speed = 175;
		const prevVelocity = player.body.velocity.clone();

  // Stop any previous movement from the last frame
		player.body.setVelocity(0);

  // Horizontal movement
		if (cursors.left.isDown) {
			player.body.setVelocityX(-speed);
		} else if (cursors.right.isDown) {
			player.body.setVelocityX(speed);
		}

	// Vertical movement
		if (cursors.up.isDown) {
			player.body.setVelocityY(-speed);
		} else if (cursors.down.isDown) {
			player.body.setVelocityY(speed);
		}
		player.body.velocity.normalize().scale(speed);
	//Animaciones	
		if (cursors.right.isDown) {
			player.anims.play("walk-right", true);
		} else if (cursors.left.isDown){
			player.anims.play("walk-left", true);
		} else if (cursors.up.isDown){
			player.anims.play("walk-up", true);
		} else if (cursors.down.isDown){
			player.anims.play("walk-down", true);
		}else {player.anims.stop();}
		
		
		}
    </script>

</body>
</html>